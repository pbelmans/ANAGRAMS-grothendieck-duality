\documentclass[10pt,a4paper]{article}
\input{packages}
\input{configuration}
\input{macros}

\title{Grothendieck duality: lecture 2 \\[.2em] \Large More on Riemann--Roch and Serre duality, with applications}
\author{Pieter Belmans}
\date{January 15, 2014}

\begin{document}
\maketitle

\begin{abstract}
  These are the notes for my second lecture on Grothendieck duality in the ANAGRAMS seminar. They continue the discussion of Riemann--Roch and Serre duality started in the first lecture, by giving some applications.

  Then we recall some of the preliminaries required for a statement of Grothendieck duality, to end with some possible manifestations of this general duality result.
\end{abstract}

\tableofcontents

\clearpage

\section{Applications of Riemann--Roch for curves}
\label{section:applications-curves}
As the first lecture didn't allow for a discussion of any applications I have moved these to (the notes of) the second lecture.

\subsection{Geometric genus equals arithmetic genus}
For a projective nonsingular curve~$C$ we get that~$\mathrm{p}_{\mathrm{arith}}(C)=1-\chi(C,\mathcal{O}_C)=\hh^1(C,\mathcal{O}_C)=\hh^0(C,\Omega_C^1)=\mathrm{p}_{\mathrm{geom}}(C)$. Hence the arithmetic and geometric genus agree. The geometric genus ``counts the number of holes'' whereas the arithmetic genus doesn't really count anything (it can be negative in more general situations\footnote{E.g., the disjoint union of two~$\mathbb{P}_k^1$'s, because its arithmetic genus equals\begin{equation}1-\chi(\mathbb{P}_k^1\sqcup\mathbb{P}_k^1,\mathcal{O}_{\mathbb{P}_k^1\sqcup\mathbb{P}_k^1})=1-(2-0)=-1.\end{equation}.}, because its generalisation is an alternating sum).

\subsection{Curves of degree~$d$ in~$\mathbb{P}_k^n$}
If~$C$ is given as a curve of degree~$d$ in~$\mathbb{P}_k^n$ we can take a hyperplane section~$C\cap H=D$ for a divisor. Then we get
\begin{equation}
  \chi(\mathcal{L}(D))=d+1-\mathrm{p}_{\mathrm{a}}(C)
\end{equation}
as the degree of the divisor~$D$ is always~$d$, which can be considered an application of B\'ezout's theorem.

\subsection{Vanishing of~$\HH^1$}
The theorem of Riemann--Roch should be view in terms of the \emph{Riemann--Roch problem}, which is the study of the (asymptotic) behaviour of~$\hh^0(C,\mathcal{O}_C(np))$, for~$p\in C$, or more general divisors. So the question becomes: can we determine~$\hh^1$, or the~$\hh^0$ of~$\omega_C(-D)$? The answer is given in \cite[remark IV.1.3.2]{hartshorne-algebraic-geometry}:
\begin{lemma}
  If~$\deg(D)>0$ and~$n\deg(D)>\deg(\mathrm{K}_C)$ then~$\hh^0(C,\mathcal{O}_C(\mathrm{K}_C-nD))=0$.

  \begin{proof}
    This is an application of \cite[lemma IV.1.2]{hartshorne-algebraic-geometry}: if~$\hh^0(C,\mathcal{O}_C(D))\geq 1$ for some divisor~$D$ we have~$\deg(D)\geq 0$. To prove this statement, observe that we can obtain an \emph{effective} divisor~$D'$ linearly equivalent to~$D$, because we can use the non-zero global sections of~$\mathcal{O}_C(D)$ and take the \emph{divisor of zeroes} \cite[proposition II.7.7]{hartshorne-algebraic-geometry}. Hence~$\deg(D)=\deg(D')\geq 1$.

    So if~$n\deg(D)>\deg(\mathrm{K}_C)$ we get~$\deg(\mathrm{K}_C-nD)\leq -1$ and therefore
    \begin{equation}
      \hh^0(C,\mathcal{O}_C(\mathrm{K}_C-nD))=0.
    \end{equation}
  \end{proof}
\end{lemma}
So if~$\mathrm{K}_C-nD$ becomes ``sufficiently negative'' its~$\HH^0$ will vanish, hence we have solved the Riemann--Roch problem!

\subsection{The degree of the canonical divisor}
The canonical divisor still might be a mysterious beast. But Riemann--Roch at least tells us its degree: applying it to~$\mathrm{K}_C$ and using the definition of the genus we get
\begin{equation}
  g-1=\deg(\mathrm{K}_C)+1-g
\end{equation}
i.e.\ $\deg(\mathrm{K}_C)=2g-2$.

So for~$\mathbb{P}_k^1$, where the genus is~$0$, we get that the canonical divisor is the~$-2\infty$ we've seen before. For elliptic curves (i.e.\ curves of genus~$1$) we get that the canonical divisor has degree~$0$, and again because the genus is~$1$ we know that there are (only) the constants as differentials, hence the canonical divisor is equivalent to~$0$.

\subsection{Rational function with pole in a point}
The Riemann--Roch problem has several special cases. One of them is the following situation \cite[exercise IV.1.1]{hartshorne-algebraic-geometry}:
\begin{quote}
  There exists a nonconstant rational function which is regular everywhere except at a given point~$p$.
\end{quote}
It suffices to take~$D=p$ in the context of the Riemann--Roch problem, and as soon as~$n>\deg(\mathrm{K}_C)$ we have a non-zero global section for~$\mathcal{O}_C(np)$. By the previous results on the degree of the canonical divisor we can easily understand how high we should at least go:
\begin{enumerate}
  \item if~$C=\mathbb{P}_k^1$ then~$n=1$ suffices as the degree of the canonical divisor is~$-2$, our point~$p\in\mathbb{P}_k^1$ corresponds to an~$a\in\mathbb{C}$ on some affine chart, the desired rational function with a pole in~$p$ is nothing but~$(z-a)^{-1}$;
  \item if~$C$ is an elliptic curve the degree of the canonical divisor is~$0$, so again~$n=1$ suffices;
  \item for higher genus curves the choice of~$n>2g-2$ will always give us a rational function, but in general a lower number could do. This is discussed further in the paragraph on Weierstrass gaps.
\end{enumerate}

\subsection{Rational functions with poles in several points}
In a completely analogous manner we can find rational functions with poles in any number of points, as long as we don't put a bound on the multiplicity of the pole. This is \cite[exercise IV.1.2]{hartshorne-algebraic-geometry}. At this rate we will have solved all the exercises of this section in a whim\footnote{I won't do this though, but you are cordially invited to do them as they are interesting and not as frightening as most exercises in Hartshorne's book.}

\subsection{Weierstrass points}
We had the Riemann--Roch problem for a divisor of the form~$np$, where we were interested in the numbers~$\hh^0(C,\mathcal{O}_C(np))$. These numbers count the rational functions with prescribed behaviour. If~$n>\deg(\mathrm{K}_C)=2g-2$ we had a complete knowledge about the behaviour. On the other hand, if~$n\leq -1$ we have no global sections, whereas~$n=0$ yields the constants. For~$n=2g-1$ on the other hand we get
\begin{equation}
  \hh^0(C,\mathcal{O}_C((2g-1)p))=2g-1-g+1=g
\end{equation}
and for~$n=2g-1+k$ we get~$g+k$ as the correction term will always be zero. Hence we get the following table
\begin{table}
  \centering
  \begin{tabular}{cccccccccc}
    $n$ & -1 & 0 & 1 & 2 & \dots & $2g-2$ & $2g-1$ & $2g$ & \dots \\\midrule
    $\hh^0(C,\mathcal{O}_C(np)$ & 0 & 1 & ? & ? & ? & ? & $g$ & $g+1$ & \dots
  \end{tabular}
  \caption{Behaviour of $\hh^0(C,\mathcal{O}_C(np)$}
  \label{table:np}
\end{table}
We also know that
\begin{enumerate}
  \item the numbers that we fill in have to be increasing: if a pole of order at most~$n$ in~$p$ exists, it surely exists if we allow poles of order~$n+1$;
  \item they can moreover only increase by at most~$1$: if~$f$ and~$g$ are rational functions with a pole of the same order, then there exists a constant~$c$ such that~$f+cg$ has a pole of lower order (by cancelling the leading term in the local expression for~$f$ and~$g$).
\end{enumerate}
For low genera we also know what happens:
\begin{enumerate}
  \item $g=0$ has no missing terms, it is (starting from~$n=-1$)
    \begin{equation}
      0, 1, 2, 3, 4, 5, \dotsc
    \end{equation}
  \item $g=1$ has no missing terms, it is (starting from~$n=-1$) 
    \begin{equation}
      0, 1, 1, 2, 3, 4, \dotsc
    \end{equation}
  \item $g=2$ has one missing term, it is (starting form~$n=-1$)
    \begin{equation}
      0, 1, 1, ? , 2, 3, \dotsc
    \end{equation}
\end{enumerate}
What we don't know is whether the sequence of numbers will depend on the choice of~$p$ (it does). It is a bit mysterious at first sight, but on a genus~$2$ curve there will be exactly~$6$ points\footnote{These 6 points correspond to the ramification points of the degree 2 map to~$\mathbb{P}_k^1$: every genus~$2$ curve is hyperelliptic, i.e.\ given by~$y^2=f(x)$ for~$f$ of degree~$5$ or~$6$.} for which the missing term is~$2$, whereas all the others have missing terms~$1$. This behaviour is the same for all higher genera: there are finitely many points in which the behaviour is ``not as expected'', where the expectation is that the sequence starts with~$g+1$ copies of~$1$, after which it increases by~$1$ each time. Moreover, the number of exceptional points is~$g(g^2-1)$ (if one weighs them).

\begin{definition}
  The points with ``exceptional behaviour'' as explained before are called \emph{Weierstrass points}
\end{definition}

The sequence of missing terms associated to such a Weierstrass point is interesting to study, and depends on the type of curve we are considering. This ties in with the use of Riemann--Roch in the classification of curves. In the case of hyperelliptic curves (in arbitrary genus) the Weierstrass points are exactly the ramification points (with their correct weights!) but in general it's harder to say what they correspond to geometrically.

\subsection{The group law on elliptic curves}
The Riemann--Roch theorem is also useful in proving that an elliptic curve~$E$ has a group structure. If one wishes to construct the group law by purely geometric notions proving the associativity is a bit hard (which is odd, because most of the times this axiom is rather easy to check). But there is an obvious group structure on the divisors, which we can put to good use.

To do so we will need~$\Pic^0(E)$, this is the subgroup of degree-zero elements of~$\Pic(E)$ which is the group of all divisors modulo linear equivalence. The divisor of a rational function has degree zero, hence we have defined
\begin{equation}
  \Pic^0(E)=\{D\in\Div(E)\mid\deg(D)=0\}/\{\div(f)\mid f\in k(E)\}.
\end{equation}
Then we pick a neutral element~$p_0\in E$. This yields the map
\begin{equation}
  E\mapsto\Pic^0(E):p\mapsto\mathcal{O}_E(p-p_0).
\end{equation}
To see that this is a surjection, we take~$D$ a divisor of degree~$0$. We wish to show that there exists a unique point~$p\in E$ such that~$D$ is linearly equivalent to~$p-p_0$. As the degree of the canonical divisor is~$0$ we get~$\deg(\mathrm{K}_E-D-p_0)=-1$, so~$\hh^0(E,\mathcal{O}_E(\mathrm{K}_E-D-p_0))=0$. Hence~$\hh^0(E,\mathcal{O}_E(D+p_0))=1$. As before we can find an effective divisor linearly equivalent do~$D+p_0$, but as the the dimension is~$1$ and by applying \cite[proposition II.7.7]{hartshorne-algebraic-geometry} we get that this divisor is unique (the linear system is zero-dimensional). As the degree of this divisor is~$1$ we get a single point~$p$, i.e.\ the divisor~$p$ is rationally equivalent to~$D+p_0$, or~$D=p-p_0$ in~$\Pic^0(E)$.

\subsection{Classification of curves}
Time and space don't permit me to write anything about it, but Riemann--Roch is crucial in tackling classification problems for curves.


\section{Applications of Riemann--Roch for surfaces}
\label{section:applications-surfaces}
\subsection{Irregularity of a surface}
Let~$S$ be a projective nonsingular surface. Its geometric genus is~$\mathrm{p}_{\mathrm{geom}}(S)=\hh^0(S,\omega_S)=\hh^2(S,\mathcal{O}_S)$ whereas its arithmetic genus is~$\mathrm{p}_{\mathrm{arith}}(S)=\hh^2(S,\mathcal{O}_S)-\hh^1(S,\mathcal{O}_S)$. Hence~$\mathrm{p}_{\mathrm{geom}}(S)\geq\mathrm{p}_{\mathrm{arith}}(S)$. Originally the Italian school thought (without knowing what sheaf cohomology was, they did all these things in more classical terms) that there was an equality. When they found out there are surfaces that have the strict inequality they dubbed the difference the \emph{irregularity}.

\subsection{Vanishing of~$\HH^2$}
As in the case of curves we have a criterion for the vanishing of a cohomology group if a certain numerical criterion is satisfied \cite[lemma V.1.7]{hartshorne-algebraic-geometry}.
\begin{proposition}
  Let~$H$ be an ample divisor on a surface~$S$. Then there exists an integer~$n_0$ (in fact, it is~$\mathrm{K}_S\cdot H$) such that, if~$D$ is a divisor for which~$D\cdot H>n_0$, then~$\HH^2(S,\mathcal{L}(D))=0$.
\end{proposition}
Recall that the situation for curves asks~$\deg D>n_0=2\mathrm{g}_C-2$ for~$\HH^1(C,\mathcal{L}(D))$ to be zero.

These vanishing results are pervasive throughout algebraic geometry. As we've seen in this talk the correct notion to study is the Euler--Poincar\'e characteristic, which incorporates all cohomological information. If one is interested in a single number though (which one often is) this requires these vanishing results in order to obtain a conclusion on this single number.

\subsection{Invariants of special surfaces}
Surfaces come in a wealth of families or shapes. Often we can find interesting (numerical) information for a specific choice of surface(s).
\begin{enumerate}
  \item If~$S$ is a surface of degree~$d$ in~$\mathbb{P}_k^3$ (i.e.\ defined by a homogeneous equation of degree~$4$ in four variables such that the Jacobian matrix is nonsingular) then the self-intersection of the canonical divisor~$\mathrm{K}_S$ is given by
    \begin{equation}
      \mathrm{K}_S\cdot\mathrm{K}_S=d(d-4)^2.
    \end{equation}
    Hence this number depends on~$d$, in the same way~$\deg(\mathrm{K}_C)$ depended on~$g$.
  \item If~$S$ is again a surface of degree~$d$ in~$\mathbb{P}_k^3$ such that it contains a straight line~$C=\mathbb{P}_k^1$ then~$C\cdot C=2-d$. Hence we get negative self-intersection if~$d\geq 3$, which at first is a truly counterintuitive thing. In characteristic~$0$ one can find such a surface for any choice of~$d$.
  \item If~$S=C\times C'$ is a product of two curves of genus~$g$ and~$g'$ respectively, then
    \begin{equation}
      \mathrm{K}_{C\times C'}=8(g-1)(g'-1).
    \end{equation}
\end{enumerate}


\section{Reminder on derived categories}
\label{section:derived-categories}
The main idea behind derived categories is to make working with derived functors more natural. Recall that given a left (or right) exact functor between abelian categories one can determine its derived functors, which form a family of functors. These functors measure the extent to which the original functor is not exact, and they can give interesting algebraic or geometric information (depending on the original choice of functor).

The goal is to capture all of these in one single \emph{total derived functor}. So instead of working with the family~$(\RRR^nF)_{n\in\mathbb{N}}$ one wants to construct a functor~$\RRR F$ replacing the whole family.

To calculate (co)homology one uses injective (or projective, or flat, or flabby, or~\dots depending on the context) resolutions. So instead of using a single object, it is natural to consider a whole (co)chain complex of objects. That is why, instead of using an abelian category~$\mathcal{A}$ (take for example~$\mathcal{A}=\Coh/X$ the abelian category of coherent sheaves on a scheme), one uses~$\Ch(\mathcal{A})$: the abelian category of (co)chain complexes over~$\mathcal{A}$.

Because the calculation of (co)homology is invariant up to homotopy equivalence, we construct the category~$\KKK(\mathcal{A})$ by identifying morphisms in~$\Ch(\mathcal{A})$ which are homotopy equivalent. This is an intermediate step which can be skipped, but it helps in proving the main properties of the resulting object.

The final step is the most technical one, and consists of inverting quasi-isomorphisms to obtain the \emph{derived category}. Recall that a quasi-isomorphism is a morphism which induces isomorphisms in the (co)homology, i.e.\ if~$f\colon A^\bullet\to B^\bullet$ is a morphism such that~$\HH^n(A^\bullet)\cong\HH^n(B^\bullet)$ for all~$n$ then we would like~$A^\bullet$ and~$B^\bullet$ to be isomorphic in our desired derived category. This way, an object becomes isomorphic to its resolution. The way to obtain this is analogous to the localisation of a ring: we formally add inverses. That this construction works as intended follows from the Gabriel--Zisman theorem.

To summarise, the construction goes through the following steps
\begin{enumerate}
  \item pick an abelian category~$\mathcal{A}$ ($\Coh/X$, $\Qcoh/X$ or just~$A\mhyphen\mathrm{Mod}$ if you like);
  \item consider the abelian category of (co)chain complexes over~$\mathcal{A}$;
  \item construct the category of (co)chain complexes~$\KKK(\mathcal{A})$ over~$\mathcal{A}$ by identifying the homotopy equivalences in~$\Ch(\mathcal{A})$;
  \item construct the derived category~$\derived(\mathcal{A})$ of~$\mathcal{A}$ by inverting the quasi-isomorphisms in~$\KKK(\mathcal{A})$.
\end{enumerate}
Instead of considering all (co)chain complexes, we can also consider complexes which satisfy a certain boundedness assumption. We could ask for the complexes to be
\begin{enumerate}
  \item bounded on both sides (denoted~$\derived^\bounded(\mathcal{A})$),
  \item bounded below or above (denoted~$\derived^+(\mathcal{A})$ resp.\ $\derived^-(\mathcal{A})$),
  \item concentrated in positive or negative degrees (denoted~$\derived^{\geq 0}(\mathcal{A})$ resp.\ $\derived^{\leq 0}(\mathcal{A})$).
\end{enumerate}






\printbibliography

\end{document}

