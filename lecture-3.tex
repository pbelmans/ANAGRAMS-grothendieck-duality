\documentclass[10pt,a4paper]{article}
\input{packages}
\input{configuration}
\input{macros}

\title{Grothendieck duality: lecture 3 \\[.2em] \Large Grothendieck duality and applications}
\author{Pieter Belmans}
\date{January 22, 2014}

\begin{document}
\maketitle

\begin{abstract}
  
\end{abstract}

\tableofcontents

\clearpage

\setcounter{section}{-1}
\section{Reminder on derived categories}
\label{section:derived-categories}
The main idea behind derived categories is to make working with derived functors more natural. Recall that given a left (or right) exact functor between abelian categories one can determine its derived functors, which form a family of functors. These functors measure the extent to which the original functor is not exact, and they can give interesting algebraic or geometric information (depending on the original choice of functor).

\begin{example}
  So far we have used just one derived functor, which was sheaf cohomology. The left-exact functor under consideration is~$\Gamma(X,-)$, its derived functors~$\HH^i(X,-)$.
\end{example}

There are other examples.
\begin{example}
  Global sections are a special case of pushforward: if~$f\colon X\to\Spec k$ is the structural morphism then~$f_*(-)=\Gamma(X,-)$. We obtain a sheaf on~$\Spec k$, which is nothing but a vectorspace, the only non-empty open set has~$\Gamma(f^{-1}(\Spec k),-)$ as its sections. We can conclude that~$f_*$ will not be right-exact in general as it is a generalisation of global sections.
\end{example}

The goal is to capture all of these in one single \emph{total derived functor}. So instead of working with the family~$(\RR^nF)_{n\in\mathbb{N}}$ one wants to construct a functor~$\RRR F$ replacing the whole family.

To calculate (co)homology one uses injective (or projective, or flat, or flabby, or~\dots depending on the context) resolutions. So instead of using a single object, it is natural to consider a whole (co)chain complex of objects. That is why, instead of using an abelian category~$\mathcal{A}$ (take for example~$\mathcal{A}=\Coh/X$ the abelian category of coherent sheaves on a scheme), one uses~$\Ch(\mathcal{A})$: the abelian category of (co)chain complexes over~$\mathcal{A}$.

Because the calculation of (co)homology is invariant up to homotopy equivalence, we construct the category~$\KKK(\mathcal{A})$ by identifying morphisms in~$\Ch(\mathcal{A})$ which are homotopy equivalent. This is an intermediate step which can be skipped, but it helps in proving the main properties of the resulting object.

The final step is the most technical one, and consists of inverting quasi-isomorphisms to obtain the \emph{derived category}. Recall that a quasi-isomorphism is a morphism which induces isomorphisms in the (co)homology, i.e.\ if~$f\colon A^\bullet\to B^\bullet$ is a morphism such that~$\HH^n(A^\bullet)\cong\HH^n(B^\bullet)$ for all~$n$ then we would like~$A^\bullet$ and~$B^\bullet$ to be isomorphic in our desired derived category. This way, an object becomes isomorphic to its resolution. The way to obtain this is analogous to the localisation of a ring: we formally add inverses. That this construction works as intended follows from the Gabriel--Zisman theorem.

To summarise, the construction goes through the following steps
\begin{enumerate}
  \item pick an abelian category~$\mathcal{A}$ ($\Coh/X$, $\Qcoh/X$ or just~$A\mhyphen\mathrm{Mod}$ if you like);
  \item consider the abelian category of (co)chain complexes over~$\mathcal{A}$;
  \item construct the category of (co)chain complexes~$\KKK(\mathcal{A})$ over~$\mathcal{A}$ by identifying the homotopy equivalences in~$\Ch(\mathcal{A})$;
  \item construct the derived category~$\derived(\mathcal{A})$ of~$\mathcal{A}$ by inverting the quasi-isomorphisms in~$\KKK(\mathcal{A})$.
\end{enumerate}
Instead of considering all (co)chain complexes, we can also consider complexes which satisfy a certain boundedness assumption. We could ask for the complexes to be
\begin{enumerate}
  \item bounded on both sides (denoted~$\derived^\bounded(\mathcal{A})$),
  \item bounded below or above (denoted~$\derived^+(\mathcal{A})$ resp.\ $\derived^-(\mathcal{A})$),
  \item concentrated in positive or negative degrees (denoted~$\derived^{\geq 0}(\mathcal{A})$ resp.\ $\derived^{\leq 0}(\mathcal{A})$).
\end{enumerate}

\section{Grothendieck duality}
\label{section:grothendieck-duality}
\subsection{Motivation}
\label{subsection:motivation}
There are several ways of motivating Grothendieck duality, and the desire to generalise Serre duality\footnote{If unfamiliar with Serre duality, one is either invited to read the notes to the first lecture, or glance at the summary of Serre duality later on.}. Of course, the restriction on the classical Serre duality are rather severe: we want a smooth (or mildly singular) projective variety over a field, and a vector bundle. Can we do similar things:
\begin{enumerate}
  \item for more general schemes? 
  \item over more general base schemes?
  \item for more general sheaves?
\end{enumerate}
The answer will be yes, otherwise we wouldn't be discussing Grothendieck duality.

\paragraph{Adjoint functors}
A more down-to-earth motivation for the form that Grothendieck duality often takes is given in \cite[chapter 6]{triangulated-categories}. Recall from the first lecture the statement of Serre duality, preceded by the required definition of a dualising sheaf, as given in \cite{hartshorne-algebraic-geometry}.
\begin{definition}
  Let~$X/k$ be a proper~$n$\dash dimensional variety. A \emph{dualising sheaf} for~$X$ is a coherent sheaf~$\omega_X^\circ$ together with a \emph{trace morphism}~$\tr\colon\HH^n(X,\omega_X^\circ)\to k$, such that for all~$\mathcal{F}\in\Coh/X$ the natural pairing
  \begin{equation}
    \Hom(\mathcal{F},\omega_X^\circ)\times\HH^n(X,\mathcal{F})\to\HH^n(X,\omega_X^\circ)
  \end{equation}
  composed with~$\tr$ gives an isomorphism
  \begin{equation}
    \Hom(\mathcal{F},\omega_X^\circ)\cong\HH^n(X,\mathcal{F})^\vee.
  \end{equation}
\end{definition}
Then the statement, where~$X$ admits a dualising sheaf, reads:
\begin{theorem}[Serre duality]
  \label{theorem:serre-duality}
  Let~$X/k$ be a projective~$n$\dash dimensional variety. Let~$\omega_X^\circ$ be its dualising sheaf. Then for all~$i\geq 0$ and~$\mathcal{F}\in\Coh/X$ we have functorial maps
  \begin{equation}
    \theta^i\colon\Ext^i(\mathcal{F},\omega_X^\circ)\to\HH^{n-i}(X,\mathcal{F})^\vee
  \end{equation}
  such that~$\theta^0$ corresponds to~$\tr$. Moreover, if~$X$ is Cohen--Macaulay\footnote{A technical condition that says that ``mild singularities'' are allowed. It means that each local ring has Krull dimension equal to the depth (we always have that depth is bounded above by Krull dimension), where depth corresponds to the length of a maximal regular sequence for the local ring itself. One can just read non-singular, which is the case we will need in later applications.} the~$\theta^i$ are isomorphisms for all~$i\geq 0$ and~$\mathcal{F}\in\Coh/X$.
\end{theorem}
We also obtained a corollary, which explains the name ``duality'': it relates~$\HH^i$ to~$\HH^{n-i}$, and does so by using a duality of vector spaces.
\begin{corollary}
  Let~$X$ be projective Cohen--Macaulay of (equi-)dimension~$n$ over~$k$. Let~$\mathcal{F}$ be a locally free sheaf on~$X$. Then we have isomorphisms
  \begin{equation}
    \HH^i(X,\mathcal{F})\cong\HH^{n-i}(X,\mathcal{F}^\vee\otimes\omega_X^\circ)^\vee.
  \end{equation}
\end{corollary}
This is just one of the many ways of writing the isomorphism. Another would be
\begin{equation}
  \Hom_k\left( \HH^i(X,\mathcal{F}),k \right)\cong\HH^{n-i}\left( X,\HHom(\mathcal{F},\omega_X^\circ) \right).
\end{equation}
We are almost where we want to be. The last step to take is ``go relative''. Which of course in this case is not that spectacular. So let's look at the structural morphism~$f\colon X\to\Spec k$. We are working for a vector bundle~$\mathcal{F}$ on~$X$, so we could also look at a vector bundle on~$\Spec k$, which is nothing but a finite-dimensional vectorspace~$V$. Generalising the previous equation, and applying the tensor-Hom adjunction we obtain
\begin{equation}
  \Hom_k\left( \HH^i(X,\mathcal{F}),V \right)\cong\HH^{n-i}\left( X,\HHom(\mathcal{F},V\otimes_k\omega_X^\circ) \right)\cong\Ext^{n-i}\left( \mathcal{F},V\otimes_k\omega_X^\circ \right).
\end{equation}
With a little imagination this looks like an adjunction:
\begin{enumerate}
  \item the cohomology groups~$\HH^i(X,\mathcal{F})$ can be taken together to~$\mathbf{R}f_*(\mathcal{F})$\footnote{The functor~$f_*$ in this case is nothing but global sections, as~$f_*(\mathcal{F})$ evaluated on~$\Spec k$ is~$\Gamma(f^{-1}(\Spec k),\mathcal{F})$.};
  \item by the properties of the derived category we can take~$\Ext$'s together into a~$\Hom$ in the derived category\expand{this is not yet in the introduction to derived categories!}.
\end{enumerate}
Hence we can write Serre duality as
\begin{equation}
  \Hom_{\mathbf{D}^{\mathrm{b}}(\Spec k)}\left( \mathbf{R}f_*(\mathcal{F}),V \right)\cong\Hom_{\mathbf{D}^{\mathrm{b}}(X)}\left( \mathcal{F},f^!(V) \right)
\end{equation}
where~$\mathbf{D}^{\mathrm{b}}(\Spec k)$ is the bounded derived category of finite-dimensional~$k$\dash vector spaces and~$\mathbf{D}^{\mathrm{b}}(X)$ is the bounded derived category of coherent sheaves on~$X$\footnote{For ease of statement we'll take~$X$ smooth here.}. Hence Serre duality asserts the existence of a dual
\begin{equation}
  f^!\colon\mathbf{D}^{\mathrm{b}}(\Spec k)\to\mathbf{D}^{\mathrm{b}}(X)
\end{equation}
which in this case is explicitly given by~$-\otimes_k\omega_X^\circ$. But in this statement we could easily replace~$f\colon X\to\Spec k$ by a more general~$f\colon X\to Y$, and the existence of a right adjoint~$f^!$ would still make sense!


\paragraph{Dualising complexes}
So we now that there is some virtue in looking at the relative context, and that we will obtain an adjoint pair encoding Grothendieck duality. Another thing we could do is look at the dualising sheaf. Then we can motivate Grothendieck duality by considering another rather trivial situation: $\Spec\mathbb{Z}$, as was done in \cite[\S V.1]{hartshorne-residues-and-duality}\expand.


\subsection{The ideal theorem}
The first thing we can consider as a form of Grothendieck duality is \cite[Ideal theorem on page 6]{hartshorne-residues-and-duality}. This summarises what one tries to prove to be able to speak of a ``Grothendieck duality result''. After the statement we will collect some contexts in which we can prove this.
\begin{theorem}[Ideal theorem] {\ }
  \label{theorem:classical}
  \begin{enumerate}
    \item\label{enumerate:classical-a} For every morphism $f\colon X\to Y$ of finite type of preschemes, there is a functor
      \begin{equation}
        f^!\colon\derived(Y)\to\derived(X)
      \end{equation}
      such that
      \begin{enumerate}
        \item\label{enumerate:classical-a-1} if $g\colon Y\to Z$ is a second morphism of finite type, then $(g\circ f)^!=f^!\circ g^!$;
        \item\label{enumerate:classical-a-2} if $f$ is a smooth morphism, then
          \begin{equation}
            f^!(\mathcal{G})=f^*(\mathcal{G})\otimes\omega,
          \end{equation}
          where $\omega=\Omega_{X/Y}^n$ is the sheaf of highest order differentials;
        \item\label{enumerate:classical-a-3} if $f$ is a finite morphism, then
          \begin{equation}
            f^!(\mathcal{G})=\HHom_{\mathcal{O}_Y}(f_*\mathcal{O}_X,\mathcal{G})^\sim.
          \end{equation}
      \end{enumerate}
    \item\label{enumerate:classical-b} For every proper morphism $f\colon X\to Y$ of preschemes, there is a \emph{trace morphism}
      \begin{equation}
        \Tr_f\colon\RRR f_*\circ f^!\Rightarrow\identity
      \end{equation}
      of functors from $\derived(Y)$ to $\derived(X)$ such that
      \begin{enumerate}
        \item\label{enumerate:classical-b-1} if $g\colon Y\to Z$ is a second proper morphism, then $\Tr_{g\circ f}=\Tr_g\circ\Tr_f$;
        \item\label{enumerate:classical-b-2} if $X=\mathbb{P}_Y^n$, then $\Tr_f$ is the map deduced from the canonical isomorphism $\mathbf{R}^nf_*(\omega)\cong\mathcal{O}_Y$;
        \item\label{enumerate:classical-b-3} if $f$ is a finite morphism, then $\Tr_f$ is obtained from the natural map ``evaluation at one''
          \begin{equation}
            \HHom_{\mathcal{O}_Y}(f_*\mathcal{O}_X,\mathcal{G})\to\mathcal{G}.
          \end{equation}
      \end{enumerate}
    \item\label{enumerate:classical-c} If $f\colon X\to Y$ is a proper morphism, then the duality morphism
      \begin{equation}
        \Theta_f\colon\RRRHom_X(\mathcal{F},f^!(\mathcal{G}))\to\RRRHom_Y(\mathbf{R}f_*\mathcal{F},\mathcal{G})
      \end{equation}
      obtained by composing the natural map\footnote{Obtained as the Yoneda pairing, see \cite[page 5]{hartshorne-residues-and-duality}.} above with $\Tr_f$, is an isomorphism for $\mathcal{F}\in\derived(X)$ and $\mathcal{G}\in\derived(Y)$.
  \end{enumerate}
\end{theorem}
The question is: in which situations can we prove this ideal theorem? The answer (as per \cite{hartshorne-residues-and-duality}, nowadays it is more general) is:
\begin{enumerate}
  \item noetherian schemes of finite Krull dimensions and morphisms which factor through a suitable projective space \cite[\S III.8, \S III.10, \S III.11]{hartshorne-residues-and-duality}: all statements are applied for $\derived_\qc^+(-)$ except the last in which case $\mathcal{F}$ lives in $\derived_\qc^-(X)$;
  \item noetherian schemes which admit dualizing complexes (see \cite[\S V.10]{hartshorne-residues-and-duality}, it implies finite Krull dimension) and morphisms whose fibres are of bounded dimension \cite[\S VII.3]{hartshorne-residues-and-duality}: all statements are applied to $\derived_\coh^+(-)$ except the last in which case $\mathcal{F}$ lives in $\derived_\qc^-(X)$;
  \item noetherian schemes of finite Krull dimension and smooth morphisms \cite[\S VII.4]{hartshorne-residues-and-duality}: the results in \ref{enumerate:classical-a} are applied to $\derived_\qc^+(-)$, in \ref{enumerate:classical-b} to $\derived_\qc^\bounded(-)$ and in \ref{enumerate:classical-c} to $\mathcal{F}$ in $\derived_\qc^-(X)$ and $\mathcal{G}$ in $\derived_\qc^\bounded(Y)$;
  \item noetherian schemes and arbitrary morphisms \cite[appendix]{hartshorne-residues-and-duality}, but only statements \ref{enumerate:classical-a-1}, \ref{enumerate:classical-b-1} and \ref{enumerate:classical-c}: the results are applied to $\derived(\Qcoh(-))$.
\end{enumerate}

\begin{table}
  \centering
  \begin{tabular}{cccc}
    \toprule
    situation & $X$ and $Y$                           & $f$                             \\\midrule
    1         & noetherian, finite Krull dimension    & factor through $\mathbb{P}_Y^n$ \\
    2         & noetherian with dualizing complex  \\
    3         & noetherian, finite Krull dimension    & smooth\\
    4         & noetherian \\
    \bottomrule
  \end{tabular}
  \caption{Description of the 4 situations for Grothendieck duality in \cite{hartshorne-residues-and-duality}}
  \label{table:situations}
\end{table}

\begin{table}
  \centering
  \begin{tabular}{rccc}
    \toprule
    property           & situation & $\derived(X)$       & $\derived(Y)$ \\\midrule
    existence of $f^!$ & 1         &                     & $\derived_\qc^+(Y)$ \\
                       & 2         &                     & $\derived_\coh^+(Y)$ \\
                       & 3         &                     & $\derived_\qc^\bounded(Y)$ \\
                       & 4         &                     & $\derived^+(\Qcoh/Y)$ \\\addlinespace[.5em]
    trace morphism     & 1         &                     & $\derived_\qc^+(Y)$ \\
                       & 2         &                     & $\derived_\coh^+(Y)$ \\
                       & 3         &                     & $\derived_\qc^\bounded(Y)$ \\
                       & 4         &                     & $\derived^+(\Qcoh/Y)$ \\\addlinespace[.5em]
    duality            & 1         & $\derived_\qc^-(X)$ & $\derived_\qc^+(Y)$ \\
                       & 2         & $\derived_\qc^-(X)$ & $\derived_\coh^+(Y)$ \\
                       & 3         & $\derived_\qc^-(X)$ & $\derived_\qc^\bounded(Y)$ \\
                       & 4         & $\derived(\Qcoh/X)$ & $\derived^+(\Qcoh/Y)$ \\
    \bottomrule
  \end{tabular}
  \caption{Overview of the configuration of the derived categories for each of the three parts of a Grothendieck duality context}
  \label{table:situations-derived-categories}
\end{table}

\subsection{How to recover classical results?}
\label{subsection:classical-results}

\begin{table}
  \centering
  \begin{tabular}{cc}
    \toprule
    how nice is $X$? & how nice is $\omega_X^\circ$? \\\midrule
    $X$ smooth & $\omega_X^\circ=\bigwedge^{\dim X}\Omega_X[\dim X]$ \\
    $X$ Gorenstein & $\omega_X^\circ$ shift of a line bundle by $\dim X$ \\
    $X$ Cohen--Macaulay & $\omega_X^\circ$ shift of a sheaf by $\dim X$ \\
    $X$ arbitrary & $\omega_X^\circ$ is a complex
  \end{tabular}
  \caption{Comparison of singularness of $X$ and the look of $\omega_X^\circ$}
  \label{table:comparison-X-dualising-sheaf}
\end{table}

\section{History of the results}
\label{section:history}


\section{Applications}
\label{section:applications-grothendieck-duality}
\subsection{Local duality}
\label{subsection:local-duality}

\subsection{The yoga of six functors}
\label{subsection:six-functors-yoga}

\subsection{Fourier--Mukai transforms}
\label{subsection:fourier-mukai-transforms}

\subsection{More applications}
\begin{enumerate}
  \item moduli spaces: see \cite{deligne-mumford-irreducibility-moduli-of-curves}
  \item resolution of singularities: \addreference
  \item arithmetic geometry: Eisenstein stuff \addreference
  \item enumerative geometry: \addreference
\end{enumerate}

\printbibliography

\end{document}
