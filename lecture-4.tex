\documentclass[10pt,a4paper]{article}
\input{packages}
\input{configuration}
\input{macros}

\title{Grothendieck duality: lecture 4 \\[.2em] \Large Sketches of some of the proofs}
\author{Pieter Belmans}
\date{January 29, 2014}

\begin{document}
\maketitle

\begin{abstract}
  
\end{abstract}

\tableofcontents

\clearpage

\section{Applications of Grothendieck duality}
\label{section:applications-grothendieck-duality}
Due to time constraints, both in preparing these notes and actually lecturing about them, the following list of applications is not as worked out as I want it to be.

\subsection{The yoga of six functors}
\label{subsection:six-functors-yoga}
The notion of Grothendieck duality that we have seen so far is in the following situation:
\begin{enumerate}
  \item (quasi)coherent sheaves;
  \item Zariski topology for schemes;
\end{enumerate}
But one can consider other contexts too. In the study of \'etale cohomology we have:
\begin{enumerate}
  \item torsion sheaves;
  \item \'etale topology for schemes;
\end{enumerate}
and in the case of manifolds and locally compact spaces we have Poincar\'e--Verdier duality:
\begin{enumerate}
  \item sheaves of abelian groups;
  \item locally compact spaces.
\end{enumerate}

In formalising the properties that are similar in each of these contexts we see that
\begin{itemize}
  \item we are considering ``image functors of sheaves'';
  \item we are using the monoidal structure of the category of sheaves.
\end{itemize}
In the general situation of abstract Verdier duality we can identify the following functors, for~$f\colon X\to Y$ a morphism in some category, and~$\mathcal{C}(X)$ some category of sheaves associated to~$X$.

\begin{center}
  \begin{tabular}{ccc}
    \toprule
    notation & name & signature \\\midrule
    $f^*$ & inverse image & $f^*\colon\mathcal{C}(Y)\to\mathcal{C}(X)$ \\
    $f_*$ & direct image & $f_*\colon\mathcal{C}(X)\to\mathcal{C}(Y)$ \\
    $f_!$ & exceptional (or proper, or twisted) direct image & $f_!\colon\mathcal{C}(X)\to\mathcal{C}(Y)$ \\
    $f^!$ & exceptional (or proper, or twisted) inverse image & $f^!\colon\mathcal{C}(Y)\to\mathcal{C}(X)$ \\
    $\HHom(-,-)$ & internal Hom & $\mathcal{C}(X)\times\mathcal{C}(X)\to\mathcal{C}(X)$ \\
    $-\otimes-$ & internal tensor product & $\mathcal{C}(X)\times\mathcal{C}(X)\to\mathcal{C}(X)$ \\
    \bottomrule
  \end{tabular}
\end{center}

We have relationships between these functors. These are the adjunctions
\begin{enumerate}
  \item $f^*\dashv f_*$;
  \item $f_!\dashv f^!$;
  \item $-\otimes C\dashv \HHom(C,-)$.
\end{enumerate}
In the situation of Grothendieck duality we moreover have the adjunction (with some abuse of notation, dropping~$\RRR$)
\begin{equation}
  f_*\dashv f^!
\end{equation}
if~$f\colon X\to Y$ is a proper map between the correct type of schemes. Or rather, we have~$f_*=f_!$ in this situation. But in general these are different, so we really have six functors and not just five. In the case of \'etale cohomology these six (or four) functors are also interesting to interpret, for which one is referred to \cite{milne-etale-cohomology}.

\subsection{The moduli of curves}
The paper that introduced \emph{stacks} to the world \cite{deligne-mumford-irreducibility-moduli-of-curves} also applies Grothendieck duality right from the start. The goal is to study the \emph{moduli space~$\mathcal{M}_g$ of curves of genus~$g$}, and show that it is irreducible, regardless of the choice of base field.

As they say themselves, the ``key definition of the whole paper'' is:
\begin{definition}
  Let~$S$ be any scheme. Let~$g\geq 2$. A \emph{stable curve of genus~$g$} over~$S$ is a proper flat morphism~$\pi\colon C\to S$ whose geometric fibres are reduced, connected, $1$\dash dimensional schemes~$C_s$ such that
  \begin{enumerate}
    \item $C_s$ has only ordinary double points;
    \item if~$E$ is a non-singular rational component of~$C_s$, then~$E$ meets the other components of~$C_s$ in more than~$2$ points;
    \item $\dim\HH^1(\mathcal{O}_{C_s})=g$.
  \end{enumerate}
\end{definition}
So two aspects of Grothendieck duality come to mind: the relative situation, and the (mild) singularities. We get a canonical invertible sheaf~$\omega_{C/S}$ on~$C$, which will act as a \emph{family} of sufficiently nice curves to connect any two points in the moduli space, thus proving irreducibility. One then proves the following properties of the dualising sheaf:
\begin{enumerate}
  \item $\omega_{C/S}^{\otimes n}$ is relatively very ample for~$n\geq 3$;
  \item $\pi_*(\omega_{C/S}^{\otimes n})$ is locally free of rank~$(2n-1)(g-1)$.
\end{enumerate}
The proof of these properties uses the fact that we ``almost'' get a smooth curve of genus~$g$, and we study the different irreducible components, together with the explicit manifestation of Grothendieck duality for curves with at most ordinary double points.

Hence we can conclude that, taking~$n=3$, we can realise a stable curve~$C\to S$ as a family of curves inside~$\mathbb{P}^{5g-6}$ such that the Hilbert polynomial of each point is~$(6n-1)(g-1)$.

This yields the construction of a subscheme~$\mathrm{H}_g\subseteq\mathrm{Hilb}_{\mathbb{P}^{5g-6}}^{(6n-1)(g-1)}$ of \emph{tricanonically embedded stable curves}, i.e.\ the functor described by
\begin{equation}
  \Hom_{\mathrm{Sch}}(S,\mathrm{H}_g)\cong\left\{ \left( \text{$\pi\colon C\to S$ stable; $\Proj\left( \pi_*(\omega_{C/S}^{\otimes 3}) \right)\cong\mathbb{P}_S^{5g-6}$} \right) \right\}/{\cong}
\end{equation}
for a scheme~$S$. By taking the quotient of the (open locus of smooth curves of the) scheme~$\mathrm{H}_g$ by the~$\mathrm{PGL}_{5g-6}$\dash action we obtain a model for the moduli space of (smooth) curves, and hence we can try to compute things.

From this point on the proof does not use Grothendieck duality anymore, so I will end the summary here.


\subsection{Other applications}
Each of the following applications more than deserves a proper treatment, but unfortunately this is not possible here. It is here to show how diverse applications of Grothendieck duality can get.

\paragraph{Local duality}
The study of local rings and singularities leads to working with Cohen--Macaulay rings and modules, and understanding these in as concrete terms as possible. It is related to representation theory as well.

\paragraph{Fourier--Mukai transforms}
By using the formalism of the six functors one can work with Fourier--Mukai transforms, which are an analogue of the usual Fourier transforms, but now for derived categories of sheaves on smooth projective varieties. A really nice introduction to this subject is \cite{huybrechts-fourier-mukai}.

\paragraph{Arithmetic geometry}
The relative formalism also applies to arithmetic geometry, for example in studying Eisenstein ideals \cite{mazur-modular-curves-eisenstein-ideal}.


\section{Hartshorne's proof: dualising and residual complexes}
\label{section:hartshorne}
\subsection{Context}
\label{subsection:context}
The first proof of Grothendieck duality was given by Robin Hartshorne in 1966 \cite{hartshorne-residues-and-duality}, based on notes provided by Alexander Grothendieck in 1963. As the statement and proof require the use of derived categories, Jean--Louis Verdier's ongoing work was included, and it was (as far as I can tell) the first published treatise of derived categories.

\paragraph{Issues with the proof}
This approach is the most geometric of them all, but also the most complicated. To quote Amnon Neeman \cite{neeman-grothendieck-duality-bousfield-brown}:
\begin{quote}
  [\ldots] Since derived categories are basically unsuited for local computations, the argument turns out to be quite unpleasant.
\end{quote}
If one reads the proof as outlined in \cite{hartshorne-residues-and-duality} this will become clear: after introducing the required notions of derived categories in algebraic geometry (the first 100 pages) the proof takes 250 pages. These 250 pages also only summarise many important results on local cohomology and depend heavily on technical results in the EGA's.

Moreover, the proof from \cite{hartshorne-residues-and-duality} is incomplete, and contains errors. Regarding the incompleteness the author himself says in \cite[\S II.5]{hartshorne-residues-and-duality}:
\begin{quote}
  Now these examples are only three of many more compatibilities which will come immediately to the reader's mind. I could make a big list, and in principle could prove each one on the list. [\ldots] And since the chore of inventing these diagrams and checking their commutativity is almost mechanical, the reader would not want to read them, nor I write them. [\ldots]
\end{quote}
Hence the reader is left with checking lots and lots of commutative diagrams, some of them depending on very subtle sign conventions in homological algebra!

\paragraph{Trace maps and base change}
There is an important omission from the proof: the compatibility of the trace map for smooth morphisms with arbitrary base change. If~$f\colon X\to Y$ is a proper, surjective, smooth map of schemes whose fibers are equidimensional of dimension~$n$, then we had the \emph{trace map} \cite[\S VII.4]{hartshorne-residues-and-duality}
\begin{equation}
  \gamma_f\colon\RR^nf_*(\omega_{X/Y})\to\mathcal{O}_Y
\end{equation}
which is an isomorphism if~$f$ has geometrically connected fibers. Now let
\begin{equation}
  \begin{tikzcd}
    X' \arrow{r}{v} \arrow{d}{g} & X \arrow{d}{f}Â \\
    Y' \arrow{r}{u} & Y
  \end{tikzcd}
\end{equation}
be a cartesian diagram, then we get an isomorphism
\begin{equation}
  u^*\left( \RR^nf_*(\omega_{X/Y}) \right)\to\RR^ng_*\left( v^*(\omega_{X/Y}) \right)\cong\RR^ng_*(\omega_{X'/Y'}).
\end{equation}
The desired compatibility then asserts that
\begin{equation}
  \begin{tikzcd}
    u^*\left( \RR^nf_*(\omega_{X/Y}) \right) \arrow{rr}{\cong} \arrow{rd}{u^*(\gamma_f)} & & \RR^ng_*(\omega_{X'/Y'}) \arrow{ld}{\gamma_{g}} \\
    & u^*(\mathcal{O}_Y)=\mathcal{O}_{Y'}
  \end{tikzcd}
\end{equation}
is a commutative diagram. A nice discussion of the state of this base change compatibility can be found in \cite[\S 1.1]{conrad-grothendieck-duality-and-base-change}. To summarise: the proof is left to the reader in \cite[\S VII.4]{hartshorne-residues-and-duality}, and its proof is highly non-trivial, which brings us by \cite{conrad-grothendieck-duality-and-base-change}.

\paragraph{Companion to the proof}
This book is written as a complement to the original proof, providing information on the omissions and fixing the numerous mistakes in the original proof. As the theory of derived categories was in its infancy, many things were still unclear, and this caused errors. Some of these are trivial to fix, others are severe and require a completely different proof. And to top things of: some (minor) mistakes have been found in Brian Conrad's book, but these don't require difficult fixes and a detailed erratum is available.

In total, one understands that if the proof and a companion to the proof take about 500 pages, it's hardly an easy proof.

\subsection{Outline of the proof}
Summarising 500 pages of proof is a rather non-trivial task to do, but I will try to outline my view on the proof and its structure. Hopefully this helps in tackling the proof, and identifying which parts could be of interest to the reader.

\subsection{Nagata's compactification theorem}

\subsection{Dualising complexes}
Recall from the description of duality on~$\Spec\mathbb{Z}$ (see the previous lecture) that we had a ``bounded complex of quasicoherent sheaves with coherent cohomology''. In this case all the highbrow terminology boils down to ``a bounded complex of abelian groups with finitely generated cohomology''. As the complex we considered was an injective resolution of~$\mathbb{Z}$ this condition is clearly satisfied.

By considering this particular complex we obtained a duality functor
\begin{equation}
  \dual\colon M^\bullet\to\RRRHom^\bullet(M^\bullet,\mathbb{Z})
\end{equation}
for~$M^\bullet$ an object in~$\derived_{\mathrm{fg}}^\bounded(\Ab)=\derived_{\coh}^\bounded(\Spec\mathbb{Z})$, i.e.\ applying the dual twice yields something functorially isomorphic to what you started with. This is completely analogous to the case of vectorspaces: one has to start with a finite-dimensional one to get the double dual isomorphic to the original one.

Generalising this we get to the following definition.
\begin{definition}
  Let~$X$ be locally noetherian. A complex~$\mathcal{R}^\bullet\in\derived_\coh^+(X)_\fid$ such that for each~$\mathcal{F}^\bullet\in\derived(X)$ the morphism
  \begin{equation}
    \eta\colon\mathcal{F}^\bullet\to\ddual\circ\ddual(\mathcal{F}^\bullet)=\RRRHHom^\bullet\left( \RRRHHom(\mathcal{F}^\bullet,\mathcal{R}^\bullet),\mathcal{R}^\bullet \right)
  \end{equation}
  is an isomorphism.
\end{definition}
As is fashionable in algebraic geometry, we have turned our problem into a definition. But this is a remarkably interesting definition, as we can observe the following \emph{properties}:
\begin{enumerate}
  \item the complex~$\mathcal{R}^\bullet$ is quasi-isomorphic to a bounded complex of quasicoherent injective sheaves, hence we get that~$\ddual\colon\derived(X)\to\derived(X)$ sends~$\derived_\coh^\bounded(X)$ to itself, and it interchanges~$\derived_\coh^+(X)$ and~$\derived_\coh^-(X)$;
  \item if~$X$ is regular of finite Krull dimension then~$\mathcal{O}_X$ is already a dualising complex \cite[example V.2.2]{hartshorne-residues-and-duality};
  \item one can check whether~$\mathcal{R}^\bullet$ is dualising at all the stalks of closed points of~$X$ \cite[corollary V.2.3]{hartshorne-residues-and-duality};
  \item dualising complexes are preserved by~$f^\flat$ and~$f^\sharp$ \cite[proposition V.2.4 and theorem V.8.3]{hartshorne-residues-and-duality}, hence for embeddable~$f$ we get that~$f^!$ preserves dualising complexes, and this means that we can compute~$f^!$ by the following isomorphism
    \begin{equation}
      f^!(\mathcal{F}^\bullet)\cong\ddual_X\circ\LLL f^*\circ\ddual_Y(\mathcal{F}^\bullet)
    \end{equation}
    with
    \begin{equation}
      \begin{aligned}
        \ddual_X(-)&\coloneqq\RRRHHom_X^\bullet(-,f^!(\mathcal{R}^\bullet)) \\
        \ddual_Y(-)&\coloneqq\RRRHHom_Y^\bullet(-,\mathcal{R}^\bullet)
      \end{aligned}
    \end{equation}
    if~$\mathcal{R}^\bullet$ is a dualising complex on~$Y$ and~$f\colon X\to Y$ is embeddable \cite[proposition V.8.5]{hartshorne-residues-and-duality};
  \item if more generally~$f$ is of finite type with~$Y$ noetherian and~$\mathcal{R}^\bullet$ a dualising complex on~$Y$ then~$f^!(\mathcal{R}^\bullet)$ will be one on~$X$;
  \item dualising complexes are unique up to tensoring with invertible sheaves and shifts \cite[theorem V.3.1]{hartshorne-residues-and-duality}.
\end{enumerate}
Regarding the question of its \emph{existence}, one has the following necessary and sufficient conditions \cite[\S V.10]{hartshorne-residues-and-duality}:
\paragraph{Sufficient conditions}
Hence, under which conditions can we prove the existence of a dualising complex?
\begin{enumerate}
  \item $X$ Gorenstein and of finite Krull dimension.
  \item $X$ of finite type over~$Y$ with~$Y$ admitting a dualising comlex (which has $X$ of finite type over a field~$k$ as a special case, hence we get Serre duality for arbitrary singularities).
\end{enumerate}
\paragraph{Necessary conditions}
Hence, what properties of~$X$ does the existence of a dualising complex imply?
\begin{enumerate}
  \item $X$ has finite Krull dimension.
  \item $X$ is catenary.
\end{enumerate}
As the proof of Grothendieck duality by constructing an explicit formula for~$f^!$ depends on dualising complexes, one could hope for a more general result by taking a different approach. This will be discussed later on. First we have to discuss how one can use local duality and dualising complexes to obtain a global theory.


\subsection{Residual complexes}
The problem is that we cannot glue dualising complexes together, as the derived category is not a local object \addreference. Hence we need to do some work to use our dualising complexes from the previous paragraph and obtain~$f^!$.

The idea is to take a dualising complex~$\mathcal{R}^\bullet\in\derived_\coh^+(X)$ and turn it into an actual complex (i.e.\ in some~$\Ch(X)$) which will be called the \emph{residual complex}\expand{why this terminology?}.

As we can glue actual complexes together, we can obtain a~$f^!$ by gluing residual complexes together. Of course, we need to know that it doesn't matter whether we use dualising complexes or residual complexes. I.e.\ we will look for a functor~$\cousin\colon\derived_\coh^+(X)\to\Ch_\coh^+(\Qcoh_\inj/X)$ such that~$\quotient\circ\cousin(\mathcal{R}^\bullet)\cong\mathcal{R}^\bullet$, where~$\quotient$ is the quotient functor in the construction of the derived category, and~$\Ch_\coh^+(\Qcoh_\inj/X)$ is a model for~$\derived_\coh^+(X)$.

The definition of a residual complex seems odd at first sight.
\begin{definition}
  Let~$X$ be a locally noetherian prescheme. A \emph{residual complex}~$\mathcal{K}^\bullet$ on~$X$ is a bounded below complex of quasicoherent injective~$\mathcal{O}_X$\dash modules with coherent cohomology, together with an isomorphism
  \begin{equation}
    \bigoplus_{p\in\mathbb{Z}}\cong\bigoplus_{x\in X}\mathrm{J}(x)
  \end{equation}
  where~$\mathrm{J}(x)$ is the quasicoherent injective~$\mathcal{O}_X$\dash module given by the constant sheaf with values in an injective hull of~$k(x)$ over~$\mathcal{O}_{X,x}$ on~$\mathrm{cl}(\{x\})$, and zero elsewhere.
\end{definition}
The reason why this definition is interesting can be deduced from \cite[proposition V.3.4]{hartshorne-residues-and-duality}, which gives a description of dualising complexes in the stalk. This description is given by a purity result for Ext-functors, hence considering these rather special residual complexes which are constructed from injective hulls makes sense.

The functor~$\cousin$ uses the theory of \emph{Cousin complexes}, and this is based on suitable filtrations of~$X$. For more information, see \cite[chapter IV]{hartshorne-residues-and-duality}.

This ``equivalence'' of residual and dualising complexes is one of the subtle points in the proof, and things are not correct the way they are stated. For a discussion of the problems, and a solution, see the discussion around \cite[lemma 3.2.1]{conrad-grothendieck-duality-and-base-change}.

As the equivalence is true under reasonable hypotheses, one can then define~$f^!$ along similar means using Nagata compactifications. This is where the main technical part of the proof is found \cite[\S VI.2--VI.5]{hartshorne-residues-and-duality}. It requires checking lots and lots of commutative diagrams, and this is one of the reasons for the existence of \cite{conrad-grothendieck-duality-and-base-change}.


\section{Deligne's proof: the right adjoint}
If one wishes to settle for a Grothendieck duality theory, without dualising and residual complexes, it is possible to prove the existence of the right adjoint~$f^!$ by other means \cite{deligne-appendix,verdier-twisted-inverse-image-functor}. One can then show that the remaining aspects of Grothendieck duality follow from the existence of this adjoint.


\section{Neeman's proof: Brown's representability theorem}
\label{section:neeman}
\subsection{Existence of adjoint functors}

\subsection{Application: Grothendieck duality}

\section{Murfet's proof: The mock homotopy category of projectives}
\label{section:murfet}
\subsection{Definitions}
\label{subsection:definitions}

\subsection{Proof}
\label{subsection:proof}

\section{Other proofs}
\label{section:other}
\subsection{Rigid dualising complexes}
\label{subsection:yekutieli-zhang}

\subsection{Pseudo-coherent complexes}
\label{subsection:lipman}
% figure out whether what I'm saying here is correct

% are there more?


\printbibliography

\end{document}

